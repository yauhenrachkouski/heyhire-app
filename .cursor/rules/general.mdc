---
alwaysApply: true
---
Always try to find simpliest solution. less code, faster execution, without overcomlicating. Smart, simple approach.

#Stack 
Bun
Next.js 16
## Default assumptions
- Assume Next.js 16 (App Router) is used unless explicitly stated otherwise.
- Prefer React 19.2-compatible patterns.
- Use React 19.2 features when beneficial (e.g., View Transitions), but keep changes isolated and reversible.
## Caching & rendering
- Prefer Cache Components and the `"use cache"` directive for server-side caching when appropriate.
- Prefer Partial Prerendering (PPR) patterns where they improve TTFB without sacrificing interactivity.
- When cache invalidation is needed, prefer tag-based invalidation and use `updateTag()` / `revalidateTag()` rather than ad-hoc cache busting.
## Routing & navigation
- Prefer idiomatic App Router navigation (`next/navigation`) and structure layouts to benefit from layout deduplication.
- Prefer incremental prefetching behavior; avoid manual hacks that fight the router.
## Middleware / networking boundary
- If the project uses network interception/proxying, prefer `proxy.ts` (Node.js runtime) over legacy middleware patterns for that purpose.
## Breaking-change awareness
- Treat request/route params and certain APIs as async where applicable (handle Promises correctly).
- Review `next/image` configuration and defaults when image behavior changes; adjust `images.localPatterns.search`, caching TTL, and quality settings as needed.
## Security


React 19, Tailwind CSS v4, shadcn/ui latest
Neon Postgres (serverless), Drizzle ORM (SQL migrations, schema-first)
Always and onlyuse @tabler/icons
Zod schema

Always use shdacn components with default style untill I will not  give you another styling instruction.

Don't create summary document after LLM done
Don't add mr-2 to button component when icon exist inside button

Migrations
Modify schema.ts - Make your schema changes
Generate migration - Run bun run db:generate (creates SQL in /migrations)
Review the SQL - Check the generated migration file
Apply migration - Run bun run db:migrate

Migration flow rule (Drizzle)
1) Always change src/db/schema.ts first.
2) Then run "bun run db:generate" to create a new SQL migration in /migrations.
3) Review the generated SQL and commit BOTH the schema change and the new migration files.
4) Apply changes by running "bun run db:migrate" (especially in production/staging).
5) Never use "bun run db:push" against production DBs (it may include destructive statements). Use db:push only for local dev emergencies.

Do not create fallback. Always resolve the issues and make sure flow works.

TanStack Query
- Use initialData only when query params match server-rendered state
- Always use placeholderData: keepPreviousData to prevent UI flicker during refetch
- Pass reactive data to components - never mutate table.options or query cache directly
- Let query data flow: Server → Query (with initialData) → Memoized data → Component props
- Use queryClient.setQueryData for optimistic updates, not direct mutations

Documentation
For better-auth and stripe documentation related to subscriptions, stripe use this link:
https://raw.githubusercontent.com/better-auth/better-auth/refs/heads/main/docs/content/docs/plugins/organization.mdx
https://raw.githubusercontent.com/better-auth/better-auth/refs/heads/main/docs/content/docs/plugins/stripe.mdx


Basic usage of better-auth auth, sign in, sign up, sign out, user profile, etc:
https://raw.githubusercontent.com/better-auth/better-auth/refs/heads/main/docs/content/docs/basic-usage.mdx
https://raw.githubusercontent.com/better-auth/better-auth/refs/heads/main/docs/content/docs/integrations/next.mdx


UI rules
Always use sahdcn components with default style untill I will not  give you another styling instruction.
Never add mr-2 to button component when icon exist inside button